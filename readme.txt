===================================证券收益计算引擎===================================
证券收益计算引擎用来计算用户的日收益金额、日收益率，以及其它指标（周收益率、月收益率、总收益率、总资产、总净值、净入金等）。

总收益率（近3月，近半年，近1年）可通过日收益率累乘，从而和沪深300、上证指数进行收益率曲线对比，因此日收益率的准确性龙为重要。
假设第i天(i~ [1,N])的日收益率为Ri, 则第i天的总收益率为： Ti = (1 + R1) * (1 + R2) *...* (1 + RN) - 1



证券类（含股票、基金、债券、逆回购、期货等）的日收益计算公式如下：
今日收益率 = 今日收益金额 / (昨日总资产 + 入金)

而今日收益金额有两种方式计算：
1. 总资产相减法：
   今日收益金额 = 今日总资产 - 昨日总资产 - 入金 + 出金；
2. 盈亏相加法：
   今日收益金额 = Σ（证券持仓盈亏） + Σ（证券买入盈亏） + Σ（证券卖出盈亏） + Σ（证券派息金额）；
通过验证，两种方式计算的日收益率结果相同。



收益计算引擎能支持各种复杂场景的日收益率计算：
1. T日总资产突然多出来一笔钱（场外资金汇入），这笔钱使总资产变大很多，当使用总资产相减时，会使日收益率偏离较大值，
   可以把这笔进来的钱当入金处理，从而计算出正确的收益率值；
2. 新股申购后，资金扣掉，但是市值一直为0，影响日收益率计算，可以按申购价每天补回该资产从而计算正确的值；
3. 股票质押业务，质押开始时，总资产突然变少以及质押到期时总资产突然变大，均可按入金、出金处理；
4. 转托管转入的股票导致总资产变大，可当入金处理；
5. 分红、送配、新股上市第一天，均可将多余、缺少的资金补回；

总之，只有存在特殊业务，均可按入金、出金、补回总资产方式，来修复总资产，从而计算准确的日收益率。
